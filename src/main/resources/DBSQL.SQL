CREATE TABLE KAN_PAY_TRADE_ORDER
(
    TRADE_NO VARCHAR2(32) PRIMARY KEY NOT NULL,
    OUT_TRADE_NO VARCHAR2(64),
    CREATED_TIME DATE,
    EXP_DATE DATE,
    DEAL_TIME DATE,
    PAY_AMOUNT NUMBER(15),
    REFUND_AMOUNT NUMBER(15),
    TRADE_STATE NUMBER(1),
    REFUND_STATE NUMBER(1),
    PAY_IP VARCHAR2(256),
    REMARK VARCHAR2(256),
    PAY_USER_ID VARCHAR2(64),
    CALL_BACK_URL VARCHAR2(128),
    NOTIFY_URL VARCHAR2(128)
);
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.TRADE_NO IS '交易流水，规则M+数据库时间(yymmdd)+8位序列seq_pay_tradeno';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.OUT_TRADE_NO IS '外部流水';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.CREATED_TIME IS '交易创建时间';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.EXP_DATE IS '交易过期时间';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.DEAL_TIME IS '交易完成时间';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.PAY_AMOUNT IS '交易金额';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.TRADE_STATE IS '交易状态，参考acct_domain定义';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.REFUND_STATE IS '退款状态';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.REMARK IS '备注';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.PAY_USER_ID IS '付款绑定用户标识';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.CALL_BACK_URL IS '回调地址';
COMMENT ON COLUMN KAN_PAY_TRADE_ORDER.NOTIFY_URL IS '通知地址';
CREATE INDEX IDX_KPTN_OUT_NO ON KAN_PAY_TRADE_ORDER (OUT_TRADE_NO);
CREATE INDEX IDX_KPTN_PAY_USER ON KAN_PAY_TRADE_ORDER (PAY_USER_ID, CREATED_TIME);

CREATE TABLE KAN_PAY_CHARGE_ORDER
(
    CHARGE_NO VARCHAR2(32) PRIMARY KEY NOT NULL,
    CHARGE_AMOUNT NUMBER(15),
    CHARGE_STATE NUMBER(1),
    CHARGE_TIME DATE,
    DEAL_TIME DATE,
    USER_ID VARCHAR2(64),
    OUT_CHARGE_NO VARCHAR2(32),
    PAY_FLAG NUMBER(1),
    REMARK VARCHAR2(256)
);
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.CHARGE_NO IS '充值流水，规则N+数据库时间(yyyymmdd)+8位序列seq_pay_chargeno';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.CHARGE_TIME IS '充值时间';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.CHARGE_AMOUNT IS '充值金额';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.CHARGE_STATE IS '充值状态';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.DEAL_TIME IS '完成时间';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.USER_ID IS '用户标识';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.OUT_CHARGE_NO IS '外部充值流水';
COMMENT ON COLUMN KAN_PAY_CHARGE_ORDER.PAY_FLAG IS '是否支付标识1：是 2：不是';
CREATE INDEX IDX_KCHARGE_TIME ON KAN_PAY_CHARGE_ORDER (CHARGE_TIME);
CREATE INDEX IDX_KCHARGE_USER_ID ON KAN_PAY_CHARGE_ORDER (USER_ID);


CREATE TABLE KAN_PAY_MERCHANT_ORDER
(
    PAY_NO VARCHAR2(32) PRIMARY KEY NOT NULL,
    OUT_TRADE_NO VARCHAR2(64),
    GATE_ORDER_NO VARCHAR2(128),
    BANK_ORDER_NO VARCHAR2(128),
    CREATED_TIME DATE,
    EXP_DATE DATE,
    DEAL_TIME DATE,
    CALLBACK_TIME DATE,
    PAY_AMOUNT NUMBER(15),
    COMMISSION NUMBER(15),
    REAL_AMOUNT NUMBER(15),
    TRADE_STATE NUMBER(1),
    CALLBACK_STATE NUMBER(1),
    REFUND_STATE NUMBER(1),
    REFUND_AMOUNT NUMBER(15),
    BANK_CODE VARCHAR2(12),
    BANK_NAME VARCHAR2(64),
    PAY_IP VARCHAR2(256),
    CALLBACK_URL VARCHAR2(256),
    NONTIFY_URL VARCHAR2(256),
    CHECK_NO VARCHAR2(64),
    TRADE_NO VARCHAR2(32),
    REFUND_TIME DATE,
    PAY_USER_ID VARCHAR2(32),
    REMARK VARCHAR2(256)
);
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.PAY_NO IS '商户支付订单交易流水，规则E+数据库时间(yyyymmdd)+8位序列seq_pay_payno 就是网关订单号';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.OUT_TRADE_NO IS '商户流水 随便什么单号（已存在即拒绝）';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.GATE_ORDER_NO IS '网关流水 银行返回的流水号 与银行流水相同';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.BANK_ORDER_NO IS '银行流水';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.CREATED_TIME IS '交易创建时间';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.EXP_DATE IS '交易过期时间';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.DEAL_TIME IS '交易完成时间';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.CALLBACK_TIME IS '回调商户时间';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.PAY_AMOUNT IS '交易金额';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.COMMISSION IS '手续费';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.REAL_AMOUNT IS '商户实际订单金额';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.TRADE_STATE IS '交易状态，参考acct_domain定义';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.CALLBACK_STATE IS '回调状态 回调给商户';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.REFUND_STATE IS '退款状态';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.REFUND_AMOUNT IS '退款状态 退款金额';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.BANK_CODE IS '银行编码';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.BANK_NAME IS '银行名称 干掉';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.PAY_IP IS '支付IP';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.CALLBACK_URL IS '页面回调地址 回调商户';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.NONTIFY_URL IS '服务器回调地址 后端回调给商户';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.CHECK_NO IS '对账流水';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.TRADE_NO IS '内部交易流水 干掉';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.REFUND_TIME IS '退款时间 拆分';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.PAY_USER_ID IS '待定';
COMMENT ON COLUMN KAN_PAY_MERCHANT_ORDER.REMARK IS '网关单生成备注 干掉';
CREATE INDEX IDX_KPMO_OUT_NO ON KAN_PAY_MERCHANT_ORDER (OUT_TRADE_NO);
CREATE INDEX IDX_KPMO_USER_AND_TIME ON KAN_PAY_MERCHANT_ORDER (PAY_USER_ID, CREATED_TIME);
CREATE INDEX IDX_KPMO_TRADE_NO ON KAN_PAY_MERCHANT_ORDER (TRADE_NO);

CREATE TABLE KAN_PAY_TRANSFER_ORDER
(
    TRNASFER_NO VARCHAR2(200) PRIMARY KEY NOT NULL,
    FROM_USER_ID VARCHAR2(15),
    TO_USER_ID VARCHAR2(15),
    TRANS_AMOUNT NUMBER(15),
    CREATE_TIME DATE DEFAULT sysdate,
    OPERATOR VARCHAR2(32),
    REMARK VARCHAR2(1000),
    OUT_ORDER_NO VARCHAR2(32),
    BUSI_TYPE_NAME VARCHAR2(128)
);
COMMENT ON COLUMN KAN_PAY_TRANSFER_ORDER.OUT_ORDER_NO IS '外部订单号';
COMMENT ON COLUMN KAN_PAY_TRANSFER_ORDER.BUSI_TYPE_NAME IS '业务类型名称';

CREATE TABLE KAN_ACCT_FUNDS_RECORD
(
    FUNDS_ID VARCHAR2(32) NOT NULL,
    TRADE_TYPE_ID NUMBER(8),
    USER_ID VARCHAR2(64),
    CREATED_TIME TIMESTAMP(6),
    PAYOUT_AMOUNT NUMBER(15),
    INCOME_AMOUNT NUMBER(15),
    BALANCE NUMBER(15),
    OUT_ORDER_NO VARCHAR2(64),
    ORDER_NO VARCHAR2(64),
    FUNDS_NAME VARCHAR2(64),
    FUNDS_DESC VARCHAR2(512),
    IN_OUT_TYPE NUMBER(2),
    BUSI_TYPE_ID NUMBER(8),
    BUSI_TYPE_NAME VARCHAR2(64)
);
CREATE INDEX IX_KAN_ACCT_FUNDS_RECORD_ID ON KAN_ACCT_FUNDS_RECORD (FUNDS_ID);
CREATE INDEX IX_KAN_ACCT_FUNDS_RECORD_U ON KAN_ACCT_FUNDS_RECORD (USER_ID, CREATED_TIME);
CREATE INDEX IX_KAN_ACCT_FUNDS_RECORD_T ON KAN_ACCT_FUNDS_RECORD (CREATED_TIME);
CREATE INDEX IX_KAN_ACCT_FUNDS_RECORD_OO ON KAN_ACCT_FUNDS_RECORD (OUT_ORDER_NO);


CREATE TABLE KAN_ACCT_BALANCE
(
    BALANCE_ID NUMBER(12) PRIMARY KEY NOT NULL,
    USER_ID VARCHAR2(12),
    BALANCE NUMBER(15),
    BALANCE_STATE NUMBER(1),
    LAST_DATE DATE
);
COMMENT ON COLUMN KAN_ACCT_BALANCE.BALANCE_ID IS '账本标识';
COMMENT ON COLUMN KAN_ACCT_BALANCE.USER_ID IS '账户标识';
COMMENT ON COLUMN KAN_ACCT_BALANCE.BALANCE IS '可使用的余额';
COMMENT ON COLUMN KAN_ACCT_BALANCE.BALANCE_STATE IS '余额状态，标识是否被锁定，1：正常 2：被锁定。';
COMMENT ON COLUMN KAN_ACCT_BALANCE.LAST_DATE IS '最后修改时间';
CREATE INDEX IDX_KAN_ACCT_BALANCE_USER_ID ON KAN_ACCT_BALANCE (USER_ID);

CREATE TABLE KAN_ACCT_USER
(
    USER_ID VARCHAR2(12) PRIMARY KEY NOT NULL,
    PAY_PSW VARCHAR2(1024),
    IS_USE_PAY_PSW NUMBER(1),
    COUNT_INVALID_PWD NUMBER(2),
    PWD_STRENGTH NUMBER(1),
    PAY_BASE_KEY VARCHAR2(256),
    PAY_PSW_TYPE NUMBER(1),
    PSW_QUEST VARCHAR2(1024),
    PSW_ANS VARCHAR2(1024),
    ID_TYPE NUMBER(1),
    ID_NO VARCHAR2(128),
    ACCT_STATE NUMBER(1),
    REAL_NAME VARCHAR2(128),
    EMAILL VARCHAR2(256),
    MOBILE VARCHAR2(32),
    REAL_CHECK NUMBER(1),
    CREDIT_GRADE NUMBER(8),
    REG_IP VARCHAR2(128),
    REG_TIME DATE,
    LAST_LOG_TIME DATE,
    LAST_LOG_IP VARCHAR2(128),
    ERR_LOG_NUM NUMBER(12),
    ERR_LOG_TIME DATE,
    COMPANY_NAME VARCHAR2(256)

);
COMMENT ON COLUMN KAN_ACCT_USER.PAY_PSW IS '交易密码，加密内容';
COMMENT ON COLUMN KAN_ACCT_USER.PSW_QUEST IS '密保问题';
COMMENT ON COLUMN KAN_ACCT_USER.PSW_ANS IS '密保答案';
COMMENT ON COLUMN KAN_ACCT_USER.ID_TYPE IS '证件类型，参考acct_domain定义。';
COMMENT ON COLUMN KAN_ACCT_USER.ID_NO IS '证件号码';
COMMENT ON COLUMN KAN_ACCT_USER.ACCT_STATE IS '账户状态，0：未激活 1：正常 2：Q状态';
COMMENT ON COLUMN KAN_ACCT_USER.REAL_NAME IS '真实姓名';
COMMENT ON COLUMN KAN_ACCT_USER.EMAILL IS '电子邮件';
COMMENT ON COLUMN KAN_ACCT_USER.MOBILE IS '手机号码';
COMMENT ON COLUMN KAN_ACCT_USER.REAL_CHECK IS '是否已实名认证';
COMMENT ON COLUMN KAN_ACCT_USER.CREDIT_GRADE IS '信用等级等级定义';
COMMENT ON COLUMN KAN_ACCT_USER.REG_IP IS '注册时IP地址';
COMMENT ON COLUMN KAN_ACCT_USER.REG_TIME IS '账户注册时间';
COMMENT ON COLUMN KAN_ACCT_USER.LAST_LOG_TIME IS '上次登录时间';
COMMENT ON COLUMN KAN_ACCT_USER.LAST_LOG_IP IS '上次登录IP';
COMMENT ON COLUMN KAN_ACCT_USER.ERR_LOG_NUM IS '错误登录次数，超过5次则账号锁定。';
COMMENT ON COLUMN KAN_ACCT_USER.ERR_LOG_TIME IS '错误登录时间';
COMMENT ON COLUMN KAN_ACCT_USER.COMPANY_NAME IS '店铺名称';
COMMENT ON COLUMN KAN_ACCT_USER.IS_USE_PAY_PSW IS '是否启用交易密码 1是启用';
COMMENT ON COLUMN KAN_ACCT_USER.PAY_BASE_KEY IS '交易密码盐值，与交易密码一一对应，防止有人恶意更改数据库用户密码。';
COMMENT ON COLUMN KAN_ACCT_USER.PAY_PSW_TYPE IS '支付密码类型 0老的加密策略密码 1 新的加密策略密码';
COMMENT ON COLUMN KAN_ACCT_USER.COUNT_INVALID_PWD IS '密码错误次数';
COMMENT ON COLUMN KAN_ACCT_USER.PWD_STRENGTH IS '支付密码强度 0低 1中 2高';
